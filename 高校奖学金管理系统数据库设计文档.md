# 高校奖学金管理系统数据库设计文档

## 1. 文档概述

### 1.1 文档目的

本文档详细描述了高校奖学金管理系统的数据库设计，包括数据库结构、表关系、字段定义、索引设计等内容，为系统开发提供数据库层面的指导。

### 1.2 术语定义

| 术语 | 解释 |
|------|------|
| 学生 | 系统中的基础用户，可申请奖学金、查看公示等 |
| 辅导员 | 学院中的辅导教师，负责审核学生信息和奖学金申请 |
| 学院管理员 | 负责管理学院内的奖学金评定工作 |
| 学校管理员 | 负责全校奖学金类型管理、最终审批等 |
| 系统管理员 | 负责系统用户、权限和基础配置管理 |
| 奖学金类型 | 系统支持的不同种类奖学金，如国家奖学金、校级奖学金等 |
| 申请 | 学生提交的奖学金申请记录 |
| 评审 | 对学生申请进行审核、评分的过程 |
| 公示 | 奖学金评定结果的公示信息 |
| 异议 | 对公示结果提出的质疑和反馈 |
| 发放 | 奖学金最终发放的记录 |

## 2. 数据库设计原则

1. **规范性原则**：遵循数据库设计的范式理论，避免数据冗余和异常
2. **完整性原则**：确保数据的准确性和一致性，通过主键、外键、约束等保障
3. **安全性原则**：通过权限控制、数据加密等方式保护敏感数据
4. **可扩展性原则**：设计具有良好扩展性的结构，适应未来业务发展
5. **性能优化原则**：合理设计索引，优化查询性能

## 3. 数据库环境

- **数据库管理系统**：MySQL 8.0
- **字符集**：utf8mb4（支持中文和特殊字符）
- **排序规则**：utf8mb4_unicode_ci
- **存储引擎**：InnoDB（支持事务和外键）

## 4. 实体关系图(ERD)

```mermaid
erDiagram
    STUDENT ||--o{ USER : is
    STUDENT ||--o{ ACADEMIC_INFO : has
    STUDENT ||--o{ PERFORMANCE : has
    STUDENT ||--o{ REVIEW : has
    SCHOLARSHIP_TYPE ||--o{ REVIEW : reviews
    REVIEW ||--o{ USER : reviewed_by
    ANNOUNCEMENT ||--o{ OBJECTION : receives
    OBJECTION ||--o{ USER : submitted_by
    USER ||--o{ LOG : generates
    
    USER {
        VARCHAR(32) user_id PK
        VARCHAR(20) username
        VARCHAR(64) password
        VARCHAR(20) role
        VARCHAR(50) email
        VARCHAR(20) phone
        DATETIME create_time
        DATETIME update_time
        TINYINT status
    }
    
    STUDENT {
        VARCHAR(20) student_id PK
        VARCHAR(32) user_id FK
        VARCHAR(10) name
        VARCHAR(2) gender
        DATE birth_date
        VARCHAR(50) major
        VARCHAR(50) college
        VARCHAR(20) class_name
        VARCHAR(18) id_card
        VARCHAR(50) contact_phone
        VARCHAR(100) address
        DATETIME enrollment_date
        DATETIME graduation_date
        TINYINT status
    }
    
    ACADEMIC_INFO {
        VARCHAR(36) info_id PK
        VARCHAR(20) student_id FK
        VARCHAR(10) academic_year
        DECIMAL(4,2) gpa
        DECIMAL(4,2) weighted_gpa
        INT credits_completed
        INT ranking_in_class
        INT total_in_class
        TEXT notes
    }
    
    PERFORMANCE {
        VARCHAR(36) performance_id PK
        VARCHAR(20) student_id FK
        VARCHAR(10) academic_year
        VARCHAR(10) performance_type
        VARCHAR(100) performance_name
        VARCHAR(50) organization
        VARCHAR(20) award_level
        DATE award_date
        VARCHAR(255) description
        VARCHAR(255) attachment_path
    }
    
    SCHOLARSHIP_TYPE {
        VARCHAR(10) type_id PK
        VARCHAR(50) type_name
        DECIMAL(10,2) amount
        INT quota
        TEXT eligibility_criteria
        TEXT application_materials
        VARCHAR(100) review_rules
        TINYINT status
        VARCHAR(10) created_by
        DATETIME create_time
    }
    
    APPLICATION {
        VARCHAR(36) application_id PK
        VARCHAR(20) student_id FK
        VARCHAR(10) type_id FK
        VARCHAR(10) academic_year
        VARCHAR(255) self_statement
        TEXT application_materials
        VARCHAR(20) current_stage
        VARCHAR(50) status
        VARCHAR(255) rejection_reason
        DATETIME submit_time
        DATETIME update_time
    }
    
    REVIEW {
        VARCHAR(36) review_id PK
        VARCHAR(36) application_id FK
        VARCHAR(32) reviewer_id FK
        VARCHAR(10) review_level
        INT score
        TEXT comments
        VARCHAR(20) result
        DATETIME review_time
    }
    
    DISTRIBUTION {
        VARCHAR(36) distribution_id PK
        VARCHAR(36) application_id FK
        DECIMAL(10,2) actual_amount
        DATE distribution_date
        VARCHAR(50) payment_method
        VARCHAR(100) account_info
        VARCHAR(20) status
        VARCHAR(255) remarks
        DATETIME create_time
    }
    
    ANNOUNCEMENT {
        VARCHAR(36) announcement_id PK
        VARCHAR(100) title
        TEXT content
        DATE publish_date
        DATE end_date
        VARCHAR(20) status
        VARCHAR(32) created_by
        DATETIME create_time
        DATETIME update_time
    }
    
    OBJECTION {
        VARCHAR(36) objection_id PK
        VARCHAR(36) announcement_id FK
        VARCHAR(20) student_id FK
        TEXT objection_content
        TEXT reply_content
        VARCHAR(20) status
        DATETIME submit_time
        DATETIME reply_time
        VARCHAR(32) handler_id
    }
    
    LOG {
        VARCHAR(36) log_id PK
        VARCHAR(32) user_id FK
        VARCHAR(50) operation_type
        VARCHAR(255) operation_content
        VARCHAR(50) ip_address
        DATETIME operation_time
    }
```

## 5. 数据库表结构设计

### 5.1 用户表（user）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `user_id` | VARCHAR(32) | PRIMARY KEY | 用户ID，UUID |
| `username` | VARCHAR(20) | NOT NULL, UNIQUE | 用户名/账号 |
| `password` | VARCHAR(64) | NOT NULL | 密码（加密存储） |
| `role` | VARCHAR(20) | NOT NULL | 角色（normal:普通用户, admin:管理员用户） |
| `email` | VARCHAR(50) | UNIQUE | 邮箱 |
| `phone` | VARCHAR(20) | UNIQUE | 手机号 |
| `create_time` | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| `update_time` | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |
| `status` | TINYINT | NOT NULL, DEFAULT 1 | 状态（0：禁用，1：启用） |

### 5.2 角色权限设计

系统采用简化的权限设计，仅包含两种角色，通过用户表中的role字段实现：
- **普通用户(normal)**：拥有个人信息查看、公示结果查看、异议提交等基础权限
- **管理员用户(admin)**：拥有系统所有增删查改权限

### 5.5 学生表（student）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `student_id` | VARCHAR(20) | PRIMARY KEY | 学号 |
| `user_id` | VARCHAR(32) | NOT NULL, FOREIGN KEY, UNIQUE | 用户ID |
| `name` | VARCHAR(10) | NOT NULL | 姓名 |
| `gender` | VARCHAR(2) | NOT NULL | 性别（男/女） |
| `birth_date` | DATE | NOT NULL | 出生日期 |
| `major` | VARCHAR(50) | NOT NULL | 专业 |
| `college` | VARCHAR(50) | NOT NULL | 学院 |
| `class_name` | VARCHAR(20) | NOT NULL | 班级 |
| `id_card` | VARCHAR(18) | NOT NULL, UNIQUE | 身份证号 |
| `contact_phone` | VARCHAR(50) | NOT NULL | 联系电话 |
| `address` | VARCHAR(100) | | 家庭地址 |
| `enrollment_date` | DATETIME | NOT NULL | 入学日期 |
| `graduation_date` | DATETIME | | 毕业日期 |
| `status` | TINYINT | NOT NULL, DEFAULT 1 | 状态（0：休学，1：在读，2：毕业，3：退学） |

### 5.6 学业信息表（academic_info）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `info_id` | VARCHAR(36) | PRIMARY KEY | 信息ID，UUID |
| `student_id` | VARCHAR(20) | NOT NULL, FOREIGN KEY | 学号 |
| `academic_year` | VARCHAR(10) | NOT NULL | 学年（如：2023-2024） |
| `gpa` | DECIMAL(4,2) | | GPA（平均学分绩点） |
| `weighted_gpa` | DECIMAL(4,2) | | 加权GPA |
| `credits_completed` | INT | | 已修学分 |
| `ranking_in_class` | INT | | 班级排名 |
| `total_in_class` | INT | | 班级总人数 |
| `notes` | TEXT | | 备注 |

### 5.7 表现记录表（performance）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `performance_id` | VARCHAR(36) | PRIMARY KEY | 表现记录ID，UUID |
| `student_id` | VARCHAR(20) | NOT NULL, FOREIGN KEY | 学号 |
| `academic_year` | VARCHAR(10) | NOT NULL | 学年（如：2023-2024） |
| `performance_type` | VARCHAR(10) | NOT NULL | 表现类型（竞赛/获奖/活动等） |
| `performance_name` | VARCHAR(100) | NOT NULL | 表现名称 |
| `organization` | VARCHAR(50) | NOT NULL | 组织单位 |
| `award_level` | VARCHAR(20) | | 获奖等级 |
| `award_date` | DATE | NOT NULL | 获奖日期 |
| `description` | VARCHAR(255) | | 描述 |
| `attachment_path` | VARCHAR(255) | | 附件路径 |

### 5.8 奖学金类型表（scholarship_type）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `type_id` | VARCHAR(10) | PRIMARY KEY | 奖学金类型ID |
| `type_name` | VARCHAR(50) | NOT NULL, UNIQUE | 奖学金名称 |
| `amount` | DECIMAL(10,2) | NOT NULL | 金额 |
| `quota` | INT | NOT NULL | 名额 |
| `eligibility_criteria` | TEXT | NOT NULL | 评选条件 |
| `application_materials` | TEXT | | 申请材料要求 |
| `review_rules` | VARCHAR(100) | | 评审规则 |
| `status` | TINYINT | NOT NULL, DEFAULT 1 | 状态（0：停用，1：启用） |
| `created_by` | VARCHAR(10) | | 创建人ID |
| `create_time` | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |

### 5.9 申请记录表（application）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `application_id` | VARCHAR(36) | PRIMARY KEY | 申请ID，UUID |
| `student_id` | VARCHAR(20) | NOT NULL, FOREIGN KEY | 学号 |
| `type_id` | VARCHAR(10) | NOT NULL, FOREIGN KEY | 奖学金类型ID |
| `academic_year` | VARCHAR(10) | NOT NULL | 申请学年 |
| `self_statement` | VARCHAR(255) | | 个人陈述 |
| `application_materials` | TEXT | | 申请材料列表 |
| `current_stage` | VARCHAR(20) | NOT NULL | 当前阶段（提交/学院审核/学校审核/公示/发放） |
| `status` | VARCHAR(50) | NOT NULL | 状态（待审核/审核通过/审核拒绝/已公示/已发放） |
| `rejection_reason` | VARCHAR(255) | | 拒绝原因 |
| `submit_time` | DATETIME | NOT NULL | 提交时间 |
| `update_time` | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

### 5.10 评审记录表（review）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `review_id` | VARCHAR(36) | PRIMARY KEY | 评审ID，UUID |
| `application_id` | VARCHAR(36) | NOT NULL, FOREIGN KEY | 申请ID |
| `reviewer_id` | VARCHAR(32) | NOT NULL, FOREIGN KEY | 评审人ID（用户ID） |
| `review_level` | VARCHAR(10) | NOT NULL | 评审级别（学院/学校） |
| `score` | INT | | 评分 |
| `comments` | TEXT | | 评审意见 |
| `result` | VARCHAR(20) | NOT NULL | 评审结果（通过/拒绝/待定） |
| `review_time` | DATETIME | NOT NULL | 评审时间 |

### 5.11 发放记录表（distribution）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `distribution_id` | VARCHAR(36) | PRIMARY KEY | 发放记录ID，UUID |
| `application_id` | VARCHAR(36) | NOT NULL, FOREIGN KEY, UNIQUE | 申请ID |
| `actual_amount` | DECIMAL(10,2) | NOT NULL | 实际发放金额 |
| `distribution_date` | DATE | NOT NULL | 发放日期 |
| `payment_method` | VARCHAR(50) | NOT NULL | 发放方式（银行卡/现金） |
| `account_info` | VARCHAR(100) | | 账户信息 |
| `status` | VARCHAR(20) | NOT NULL | 状态（待发放/已发放/发放失败） |
| `remarks` | VARCHAR(255) | | 备注 |
| `create_time` | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |

### 5.12 公示表（announcement）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `announcement_id` | VARCHAR(36) | PRIMARY KEY | 公示ID，UUID |
| `title` | VARCHAR(100) | NOT NULL | 公示标题 |
| `content` | TEXT | NOT NULL | 公示内容 |
| `publish_date` | DATE | NOT NULL | 发布日期 |
| `end_date` | DATE | NOT NULL | 结束日期 |
| `status` | VARCHAR(20) | NOT NULL | 状态（草稿/发布中/已结束） |
| `created_by` | VARCHAR(32) | NOT NULL | 创建人ID |
| `create_time` | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| `update_time` | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新时间 |

### 5.13 异议表（objection）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `objection_id` | VARCHAR(36) | PRIMARY KEY | 异议ID，UUID |
| `announcement_id` | VARCHAR(36) | NOT NULL, FOREIGN KEY | 公示ID |
| `student_id` | VARCHAR(20) | NOT NULL, FOREIGN KEY | 学生学号 |
| `objection_content` | TEXT | NOT NULL | 异议内容 |
| `reply_content` | TEXT | | 回复内容 |
| `status` | VARCHAR(20) | NOT NULL | 状态（待处理/处理中/已处理/已驳回） |
| `submit_time` | DATETIME | NOT NULL | 提交时间 |
| `reply_time` | DATETIME | | 回复时间 |
| `handler_id` | VARCHAR(32) | | 处理人ID |

### 5.14 日志表（log）

| 字段名 | 数据类型 | 约束 | 描述 |
| :--- | :--- | :--- | :--- |
| `log_id` | VARCHAR(36) | PRIMARY KEY | 日志ID，UUID |
| `user_id` | VARCHAR(32) | NOT NULL, FOREIGN KEY | 操作用户ID |
| `operation_type` | VARCHAR(50) | NOT NULL | 操作类型 |
| `operation_content` | VARCHAR(255) | NOT NULL | 操作内容 |
| `ip_address` | VARCHAR(50) | NOT NULL | IP地址 |
| `operation_time` | DATETIME | NOT NULL | 操作时间 |

## 6. 索引设计

### 6.1 主键索引

- `user` 表：`user_id`
- `role` 表：`role_id`
- `permission` 表：`permission_id`
- `role_permission` 表：复合主键 `(role_id, permission_id)`
- `student` 表：`student_id`
- `academic_info` 表：`info_id`
- `performance` 表：`performance_id`
- `scholarship_type` 表：`type_id`
- `application` 表：`application_id`
- `review` 表：`review_id`
- `distribution` 表：`distribution_id`
- `announcement` 表：`announcement_id`
- `objection` 表：`objection_id`
- `log` 表：`log_id`

### 6.2 外键索引

- 注：用户角色通过user表的role字段直接存储，不再使用外键关联
- `student` 表：`user_id`
- `academic_info` 表：`student_id`
- `performance` 表：`student_id`
- `review` 表：`student_id`, `scholarship_type_id`, `reviewer_id`
- `announcement` 表：`created_by`
- `objection` 表：`announcement_id`, `student_id`, `handler_id`
- `log` 表：`user_id`

### 6.3 非主键索引

- `user` 表：`username`(唯一), `email`(唯一), `phone`(唯一)
- `student` 表：`name`, `id_card`(唯一), `college`, `major`
- `scholarship_type` 表：`type_name`(唯一), `status`
- `review` 表：`student_id, scholarship_type_id`, `reviewer_id`, `review_result, review_time`
- `announcement` 表：`title`, `publish_date`, `status`
- `objection` 表：`announcement_id, status`, `student_id`
- `log` 表：`user_id, operation_time`, `operation_type`

## 7. 视图设计

### 7.1 学生用户信息视图（v_student_user）

```sql
CREATE VIEW v_student_user AS
SELECT 
    s.student_id,
    s.name,
    s.gender,
    s.birth_date,
    s.major,
    s.college,
    s.class_name,
    s.id_card,
    s.contact_phone,
    s.address,
    s.enrollment_date,
    s.graduation_date,
    s.status AS student_status,
    u.username,
    u.email,
    u.phone AS user_phone,
    u.create_time,
    u.update_time,
    u.status AS user_status
FROM student s
JOIN user u ON s.user_id = u.user_id;
```

### 7.2 申请详情视图（v_application_detail）

```sql
CREATE VIEW v_application_detail AS
SELECT 
    a.application_id,
    a.student_id,
    s.name AS student_name,
    s.college,
    s.major,
    a.type_id,
    st.type_name,
    st.amount AS standard_amount,
    a.academic_year,
    a.self_statement,
    a.current_stage,
    a.status,
    a.rejection_reason,
    a.submit_time,
    a.update_time,
    d.actual_amount,
    d.distribution_date,
    d.status AS distribution_status
FROM application a
JOIN student s ON a.student_id = s.student_id
JOIN scholarship_type st ON a.type_id = st.type_id
LEFT JOIN distribution d ON a.application_id = d.application_id;
```

### 7.3 评审记录视图（v_review_record）

```sql
CREATE VIEW v_review_record AS
SELECT 
    r.review_id,
    r.application_id,
    a.student_id,
    s.name AS student_name,
    st.type_name,
    r.reviewer_id,
    u.username AS reviewer_name,
    ur.role_id,
    ro.role_name,
    r.review_level,
    r.score,
    r.comments,
    r.result,
    r.review_time
FROM review r
JOIN application a ON r.application_id = a.application_id
JOIN student s ON a.student_id = s.student_id
JOIN scholarship_type st ON a.type_id = st.type_id
JOIN user u ON r.reviewer_id = u.user_id
JOIN role ro ON u.role_id = ro.role_id;
```

## 8. 存储过程和触发器设计

### 8.1 存储过程设计

#### 8.1.1 提交奖学金申请（sp_submit_application）

```sql
DELIMITER //
CREATE PROCEDURE sp_submit_application(
    IN p_student_id VARCHAR(20),
    IN p_type_id VARCHAR(10),
    IN p_academic_year VARCHAR(10),
    IN p_self_statement VARCHAR(255),
    IN p_application_materials TEXT
)
BEGIN
    DECLARE v_application_id VARCHAR(36);
    
    -- 生成UUID
    SET v_application_id = UUID();
    
    -- 插入申请记录
    INSERT INTO application (
        application_id,
        student_id,
        type_id,
        academic_year,
        self_statement,
        application_materials,
        current_stage,
        status,
        submit_time,
        update_time
    ) VALUES (
        v_application_id,
        p_student_id,
        p_type_id,
        p_academic_year,
        p_self_statement,
        p_application_materials,
        '提交',
        '待审核',
        NOW(),
        NOW()
    );
    
    -- 记录操作日志
    INSERT INTO log (log_id, user_id, operation_type, operation_content, ip_address, operation_time)
    SELECT UUID(), user_id, '提交申请', CONCAT('学生', p_student_id, '提交了奖学金申请', v_application_id), '127.0.0.1', NOW()
    FROM student WHERE student_id = p_student_id;
    
    -- 返回申请ID
    SELECT v_application_id AS application_id;
END //
DELIMITER ;
```

#### 8.1.2 处理异议（sp_handle_objection）

```sql
DELIMITER //
CREATE PROCEDURE sp_handle_objection(
    IN p_objection_id VARCHAR(36),
    IN p_reply_content TEXT,
    IN p_handler_id VARCHAR(32),
    IN p_status VARCHAR(20)
)
BEGIN
    -- 更新异议记录
    UPDATE objection
    SET 
        reply_content = p_reply_content,
        handler_id = p_handler_id,
        status = p_status,
        reply_time = NOW()
    WHERE objection_id = p_objection_id;
    
    -- 记录操作日志
    INSERT INTO log (log_id, user_id, operation_type, operation_content, ip_address, operation_time)
    VALUES (UUID(), p_handler_id, '处理异议', CONCAT('处理异议', p_objection_id, '，状态：', p_status), '127.0.0.1', NOW());
    
    -- 返回更新结果
    SELECT ROW_COUNT() AS update_count;
END //
DELIMITER ;
```

### 8.2 触发器设计

#### 8.2.1 用户密码加密触发器（trg_user_before_insert）

```sql
DELIMITER //
CREATE TRIGGER trg_user_before_insert
BEFORE INSERT ON user
FOR EACH ROW
BEGIN
    -- 使用SHA-256加密密码
    SET NEW.password = SHA2(NEW.password, 256);
END //
DELIMITER ;
```

#### 8.2.2 申请状态更新触发器（trg_application_after_update）

```sql
DELIMITER //
CREATE TRIGGER trg_application_after_update
AFTER UPDATE ON application
FOR EACH ROW
BEGIN
    -- 当状态变更为'审核通过'且当前阶段为'学校审核'时，自动创建公示
    IF NEW.status = '审核通过' AND NEW.current_stage = '学校审核' THEN
        INSERT INTO announcement (
            announcement_id,
            title,
            content,
            publish_date,
            end_date,
            status,
            created_by,
            create_time,
            update_time
        ) VALUES (
            UUID(),
            CONCAT('奖学金申请审核通过公示 - ', NEW.academic_year),
            CONCAT('学号 ', NEW.student_id, ' 的奖学金申请已通过审核。'),
            NOW(),
            DATE_ADD(NOW(), INTERVAL 7 DAY),
            '发布中',
            'system',
            NOW(),
            NOW()
        );
    END IF;
    
    -- 记录状态变更日志
    INSERT INTO log (log_id, user_id, operation_type, operation_content, ip_address, operation_time)
    VALUES (
        UUID(),
        'system',
        '申请状态更新',
        CONCAT('申请ID: ', NEW.application_id, ' 状态从 ', OLD.status, ' 变更为 ', NEW.status),
        '127.0.0.1',
        NOW()
    );
END //
DELIMITER ;
```

## 9. 数据安全设计

### 9.1 数据加密

1. **密码加密**：用户密码采用SHA-256算法加密存储
2. **敏感信息加密**：身份证号、银行卡号等敏感信息使用AES-256算法加密存储
3. **传输加密**：所有数据传输采用HTTPS协议加密

### 9.2 访问控制

1. **基于角色的访问控制（RBAC）**：通过角色表、权限表和角色权限关联表实现细粒度权限控制
2. **SQL注入防护**：使用参数化查询，避免SQL注入攻击
3. **XSS防护**：对用户输入进行过滤和转义，防止跨站脚本攻击

### 9.3 数据备份与恢复

1. **定期备份**：设置每日自动备份机制，确保数据安全
2. **增量备份**：对变更数据进行增量备份，减少备份开销
3. **备份验证**：定期验证备份数据的完整性和可用性
4. **恢复策略**：制定详细的数据恢复方案，确保在数据丢失时能够快速恢复

## 10. 性能优化策略

### 10.1 查询优化

1. **索引优化**：为频繁查询的字段创建索引，但避免过多索引影响写入性能
2. **查询语句优化**：使用JOIN替代子查询，避免全表扫描
3. **分页查询优化**：使用LIMIT分页，避免一次性返回大量数据

### 10.2 存储优化

1. **分区表**：对历史数据较多的表（如日志表）进行分区管理
2. **数据归档**：定期将历史数据归档到归档表或文件系统
3. **字段优化**：合理选择数据类型，避免使用过大的数据类型

### 10.3 缓存策略

1. **应用层缓存**：使用Redis缓存热点数据，如奖学金类型、学生基本信息等
2. **查询缓存**：合理使用MySQL查询缓存，提高查询性能

## 11. 数据初始化

### 11.1 角色数据初始化

```sql
INSERT INTO role (role_id, role_name, description) VALUES
('1', '学生', '普通学生用户'),
('2', '辅导员', '负责学生管理和奖学金初审'),
('3', '学院管理员', '负责学院奖学金管理'),
('4', '学校管理员', '负责全校奖学金管理'),
('5', '系统管理员', '系统维护和用户权限管理');
```

### 11.2 权限数据初始化

```sql
-- 基础权限
INSERT INTO permission (permission_id, permission_name, permission_url, permission_code) VALUES
('1', '用户登录', '/login', 'login'),
('2', '用户退出', '/logout', 'logout'),
('3', '查看首页', '/index', 'view_index'),

-- 学生管理权限
('101', '查看学生列表', '/student/list', 'view_student_list'),
('102', '添加学生', '/student/add', 'add_student'),
('103', '编辑学生', '/student/edit', 'edit_student'),
('104', '删除学生', '/student/delete', 'delete_student'),

-- 奖学金管理权限
('201', '查看奖学金类型', '/scholarship/type/list', 'view_scholarship_type'),
('202', '添加奖学金类型', '/scholarship/type/add', 'add_scholarship_type'),
('203', '编辑奖学金类型', '/scholarship/type/edit', 'edit_scholarship_type'),
('204', '提交申请', '/application/submit', 'submit_application'),
('205', '查看申请列表', '/application/list', 'view_application_list'),
('206', '审核申请', '/application/review', 'review_application');
```

### 11.3 角色权限关联初始化

```sql
-- 学生权限
INSERT INTO role_permission (role_id, permission_id) VALUES
('1', '1'), ('1', '2'), ('1', '3'),
('1', '101'), ('1', '201'), ('1', '204'), ('1', '205');

-- 辅导员权限
INSERT INTO role_permission (role_id, permission_id) VALUES
('2', '1'), ('2', '2'), ('2', '3'),
('2', '101'), ('2', '104'),
('2', '201'), ('2', '205'), ('2', '206');

-- 学院管理员权限
INSERT INTO role_permission (role_id, permission_id) VALUES
('3', '1'), ('3', '2'), ('3', '3'),
('3', '101'), ('3', '102'), ('3', '103'), ('3', '104'),
('3', '201'), ('3', '202'), ('3', '203'),
('3', '205'), ('3', '206');

-- 学校管理员权限
INSERT INTO role_permission (role_id, permission_id) VALUES
('4', '1'), ('4', '2'), ('4', '3'),
('4', '101'), ('4', '102'), ('4', '103'), ('4', '104'),
('4', '201'), ('4', '202'), ('4', '203'),
('4', '205'), ('4', '206');

-- 系统管理员权限
INSERT INTO role_permission (role_id, permission_id) VALUES
('5', '1'), ('5', '2'), ('5', '3'),
('5', '101'), ('5', '102'), ('5', '103'), ('5', '104'),
('5', '201'), ('5', '202'), ('5', '203'),
('5', '205'), ('5', '206');
```

### 11.4 系统管理员账号初始化

```sql
-- 系统管理员账号，密码为123456（加密后）
INSERT INTO user (user_id, username, password, role_id, email, phone, create_time, update_time, status) VALUES
(UUID(), 'admin', SHA2('123456', 256), '5', 'admin@example.com', '13800138000', NOW(), NOW(), 1);
```

## 12. 数据库维护计划

### 12.1 定期维护任务

1. **数据库备份**：每日凌晨2:00执行全量备份，每小时执行增量备份
2. **索引重建**：每周日凌晨3:00重建所有表的索引
3. **数据归档**：每学期结束后将上一学期的历史数据归档到归档表
4. **性能监控**：实时监控数据库性能，及时发现和解决性能问题

### 12.2 常见问题处理

| 问题类型 | 处理方法 |
| :--- | :--- |
| **数据库连接数过多** | 优化连接池配置，调整最大连接数，检查是否存在连接泄漏 |
| **查询性能下降** | 分析慢查询日志，优化SQL语句，调整索引结构 |
| **存储空间不足** | 清理历史数据，扩展存储，优化存储结构 |
| **数据损坏** | 使用备份恢复数据，执行数据校验和修复操作 |

## 13. 总结

本文档详细设计了高校奖学金管理系统的数据库结构，涵盖了系统所需的所有表、字段、索引、视图、存储过程和触发器。数据库设计遵循了规范化原则，确保数据的完整性和一致性，同时考虑了性能优化和安全设计。通过本设计，可以支持高校奖学金管理系统的各项功能需求，为系统的稳定运行和数据安全提供保障。